{
  "openapi": "3.1.0",
  "info": {
    "title": "Inventory Management API",
    "description": "API for managing products, warehouses, suppliers, product variants, and inventory.",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "http://localhost:5000",
      "description": "Local development server"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "summary": "Root endpoint",
        "description": "Welcome message with API documentation metadata.",
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "example": {
                  "message": "Welcome to the Inventory Management API",
                  "status": "ok",
                  "version": "1.0",
                  "documentation": {}
                }
              }
            }
          }
        }
      }
    },
    "/product": {
      "get": {
        "summary": "List all products",
        "responses": {
          "200": {
            "description": "Array of product objects",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Product" }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new product",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ProductInput" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Product created",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Product" }
              }
            }
          },
          "400": { "description": "Invalid input" }
        }
      }
    },
    "/product/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": { "type": "integer" }
        }
      ],
      "get": {
        "summary": "Get product by ID",
        "responses": {
          "200": {
            "description": "Product object",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Product" }
              }
            }
          },
          "404": { "description": "Product not found" }
        }
      },
      "put": {
        "summary": "Update product by ID",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ProductInput" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Product updated",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Product" }
              }
            }
          },
          "404": { "description": "Product not found" }
        }
      },
      "delete": {
        "summary": "Delete product by ID",
        "security": [{"bearerAuth": []}],
        "responses": {
          "200": {
            "description": "Deletion confirmation",
            "content": {
              "application/json": {
                "example": { "message": "Product deleted" }
              }
            }
          },
          "404": { "description": "Product not found" }
        }
      }
    },
    "/warehouse": {
      "get": {
        "summary": "List all warehouses",
        "responses": {
          "200": {
            "description": "Array of warehouse objects",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Warehouse" }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new warehouse",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/WarehouseInput" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Warehouse created",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Warehouse" }
              }
            }
          }
        }
      }
    },
    "/warehouse/{id}": {
      "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
      "get": {
        "summary": "Get warehouse by ID",
        "responses": {
          "200": {
            "description": "Warehouse object",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Warehouse" } } }
          },
          "404": { "description": "Warehouse not found" }
        }
      },
      "put": {
        "summary": "Update warehouse by ID",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/WarehouseInput" } } }
        },
        "responses": {
          "200": {
            "description": "Warehouse updated",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Warehouse" } } }
          },
          "404": { "description": "Warehouse not found" }
        }
      },
      "delete": {
        "summary": "Delete warehouse by ID",
        "security": [{"bearerAuth": []}],
        "responses": {
          "200": {
            "description": "Deletion confirmation",
            "content": { "application/json": { "example": { "message": "Warehouse deleted" } } }
          },
          "404": { "description": "Warehouse not found" }
        }
      }
    },
    "/supplier": {
      "get": {
        "summary": "List all suppliers",
        "responses": {
          "200": {
            "description": "Array of supplier objects",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Supplier" }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new supplier",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SupplierInput" } } }
        },
        "responses": {
          "201": {
            "description": "Supplier created",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Supplier" } } }
          }
        }
      }
    },
    "/supplier/{id}": {
      "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
      "get": {
        "summary": "Get supplier by ID",
        "responses": {
          "200": {
            "description": "Supplier object",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Supplier" } } }
          },
          "404": { "description": "Supplier not found" }
        }
      },
      "put": {
        "summary": "Update supplier by ID",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SupplierInput" } } }
        },
        "responses": {
          "200": {
            "description": "Supplier updated",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Supplier" } } }
          },
          "404": { "description": "Supplier not found" }
        }
      },
      "delete": {
        "summary": "Delete supplier by ID",
        "security": [{"bearerAuth": []}],
        "responses": {
          "200": {
            "description": "Deletion confirmation",
            "content": { "application/json": { "example": { "message": "Supplier deleted" } } }
          },
          "404": { "description": "Supplier not found" }
        }
      }
    },
    "/product_variant": {
      "get": {
        "summary": "List all product variants",
        "responses": {
          "200": {
            "description": "Array of variant objects",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/ProductVariant" }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new product variant",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ProductVariantInput" } } }
        },
        "responses": {
          "201": {
            "description": "Product variant created",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ProductVariant" } } }
          }
        }
      }
    },
    "/product_variant/{id}": {
      "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
      "get": {
        "summary": "Get product variant by ID",
        "responses": {
          "200": {
            "description": "Product variant object",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ProductVariant" } } }
          },
          "404": { "description": "Product variant not found" }
        }
      },
      "put": {
        "summary": "Update product variant by ID",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ProductVariantInput" } } }
        },
        "responses": {
          "200": {
            "description": "Product variant updated",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ProductVariant" } } }
          },
          "404": { "description": "Product variant not found" }
        }
      },
      "delete": {
        "summary": "Delete product variant by ID",
        "security": [{"bearerAuth": []}],
        "responses": {
          "200": {
            "description": "Deletion confirmation",
            "content": { "application/json": { "example": { "message": "Product variant deleted" } } }
          },
          "404": { "description": "Product variant not found" }
        }
      }
    },
    "/inventory": {
      "get": {
        "summary": "List all inventory records",
        "responses": {
          "200": {
            "description": "Array of inventory objects",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Inventory" }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new inventory record",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/InventoryInput" } } }
        },
        "responses": {
          "201": {
            "description": "Inventory record created",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Inventory" } } }
          }
        }
      }
    },
    "/inventory/{id}": {
      "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
      "get": {
        "summary": "Get inventory record by ID",
        "responses": {
          "200": {
            "description": "Inventory object",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Inventory" } } }
          },
          "404": { "description": "Inventory record not found" }
        }
      },
      "put": {
        "summary": "Update inventory record by ID",
        "security": [{"bearerAuth": []}],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/InventoryInput" } } }
        },
        "responses": {
          "200": {
            "description": "Inventory record updated",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Inventory" } } }
          },
          "404": { "description": "Inventory record not found" }
        }
      },
      "delete": {
        "summary": "Delete inventory record by ID",
        "security": [{"bearerAuth": []}],
        "responses": {
          "200": {
            "description": "Deletion confirmation",
            "content": { "application/json": { "example": { "message": "Inventory deleted" } } }
          },
          "404": { "description": "Inventory record not found" }
        }
      }
    },
    "/inventory/query": {
      "get": {
        "summary": "Query inventory with custom SQL",
        "responses": {
          "200": {
            "description": "Array of inventory query results",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/InventoryQueryResult" }
                }
              }
            }
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "summary": "Login and get JWT tokens",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": { "type": "string", "format": "email" },
                  "password": { "type": "string" }
                },
                "required": ["email", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "JWT tokens",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "access_token": { "type": "string" },
                    "refresh_token": { "type": "string" },
                    "user_id": { "type": "integer" }
                  }
                }
              }
            }
          },
          "400": { "description": "Missing email or password" },
          "401": { "description": "Bad credentials" }
        }
      }
    },
    "/auth/refresh": {
      "post": {
        "summary": "Refresh access token",
        "security": [{"bearerAuth": []}],
        "responses": {
          "200": {
            "description": "New access token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "access_token": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Product": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "sku": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "category": { "type": "string" }
        }
      },
      "ProductInput": {
        "type": "object",
        "properties": {
          "sku": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "category": { "type": "string" }
        },
        "required": ["sku", "name"]
      },
      "Warehouse": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "code": { "type": "string" },
          "name": { "type": "string" },
          "location": { "type": "string" }
        }
      },
      "WarehouseInput": {
        "type": "object",
        "properties": {
          "code": { "type": "string" },
          "name": { "type": "string" },
          "location": { "type": "string" }
        },
        "required": ["code", "name"]
      },
      "Supplier": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "name": { "type": "string" },
          "contact": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "phone": { "type": "string" }
        }
      },
      "SupplierInput": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "contact": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "phone": { "type": "string" }
        },
        "required": ["name", "email"]
      },
      "ProductVariant": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "product_id": { "type": "integer" },
          "name": { "type": "string" },
          "value": { "type": "string" }
        }
      },
      "ProductVariantInput": {
        "type": "object",
        "properties": {
          "product_id": { "type": "integer" },
          "name": { "type": "string" },
          "value": { "type": "string" }
        },
        "required": ["product_id", "name"]
      },
      "Inventory": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "product_id": { "type": "integer" },
          "variant_id": { "type": "integer", "nullable": true },
          "warehouse_id": { "type": "integer" },
          "supplier_id": { "type": "integer" },
          "quantity_on_hand": { "type": "integer" },
          "quantity_reserved": { "type": "integer" },
          "cost_price": { "type": "number", "format": "float" },
          "retail_price": { "type": "number", "format": "float" }
        }
      },
      "InventoryInput": {
        "type": "object",
        "properties": {
          "product_id": { "type": "integer" },
          "variant_id": { "type": "integer", "nullable": true },
          "warehouse_id": { "type": "integer" },
          "supplier_id": { "type": "integer" },
          "quantity_on_hand": { "type": "integer" },
          "quantity_reserved": { "type": "integer" },
          "cost_price": { "type": "number", "format": "float" },
          "retail_price": { "type": "number", "format": "float" }
        },
        "required": ["product_id", "warehouse_id", "supplier_id", "quantity_on_hand"]
      },
      "InventoryQueryResult": {
        "type": "object",
        "properties": {
          "sku": { "type": "string" },
          "product_name": { "type": "string" },
          "variant_name": { "type": "string", "nullable": true },
          "warehouse": { "type": "string" },
          "supplier": { "type": "string" },
          "quantity_on_hand": { "type": "integer" },
          "quantity_reserved": { "type": "integer" },
          "cost_price": { "type": "number", "format": "float" },
          "retail_price": { "type": "number", "format": "float" }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}
